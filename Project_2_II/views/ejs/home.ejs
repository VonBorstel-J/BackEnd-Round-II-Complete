<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Product Catalog</title>
    <!-- Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
      crossorigin="anonymous"
    />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.9.3/umd/popper.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.1.3/js/bootstrap.min.js"></script>
    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/styles.css" />
    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://use.fontawesome.com/releases/v5.15.3/css/all.css"
      crossorigin="anonymous"
    />
    <!-- Vegas JS -->
    <link rel="stylesheet" href="/vegas/vegas.min.css" />
    <!-- Favicon -->
    <link rel="icon" type="favicon-32x32.png" sizes="32x32" href="/favicon-16x16.png" />
    <link rel="icon" type="favicon-16x16.png" sizes="16x16" href="/favicon-32x32.png" />
    <script src="/components/loginModal.vue"></script>
  </head>
  <body>
    <%- include('./header') %>
    <div id="login-modal-app">
      <!-- Button to open modal -->
      <button class="btn btn-primary" @click="showModal = true">
        Login/Sign Up
      </button>
      <!-- Modal -->
      <div
        class="modal"
        tabindex="-1"
        role="dialog"
        :class="{ 'is-active': showModal }"
      >
        <div class="modal-background"></div>
        <div class="modal-card">
          <header class="modal-card-head">
            <p class="modal-card-title">{{ modalTitle }}</p>
            <button
              class="delete"
              aria-label="close"
              @click="showModal = false"
            ></button>
          </header>
          <section class="modal-card-body">
            <!-- Login form -->
            <form v-if="isLogin" @submit.prevent="login">
              <div class="field">
                <label class="label">Email</label>
                <div class="control">
                  <input class="input" type="email" v-model="email" required />
                </div>
              </div>
              <div class="field">
                <label class="label">Password</label>
                <div class="control">
                  <input
                    class="input"
                    type="password"
                    v-model="password"
                    required
                  />
                </div>
              </div>
              <div class="field">
                <div class="control">
                  <button class="button is-link" type="submit">Login</button>
                </div>
              </div>
              <div class="field">
                <p class="has-text-grey">
                  <a @click="isLogin = false"
                    >Don't have an account? Sign up here.</a
                  >
                </p>
              </div>
            </form>

            <!-- Sign up form -->
            <form v-else @submit.prevent="signup">
              <div class="field">
                <label class="label">First Name</label>
                <div class="control">
                  <input
                    class="input"
                    type="text"
                    v-model="firstName"
                    required
                  />
                </div>
              </div>
              <div class="field">
                <label class="label">Last Name</label>
                <div class="control">
                  <input
                    class="input"
                    type="text"
                    v-model="lastName"
                    required
                  />
                </div>
              </div>
              <div class="field">
                <label class="label">Email</label>
                <div class="control">
                  <input class="input" type="email" v-model="email" required />
                </div>
              </div>
              <div class="field">
                <label class="label">Password</label>
                <div class="control">
                  <input
                    class="input"
                    type="password"
                    v-model="password"
                    required
                  />
                </div>
              </div>
              <div class="field">
                <div class="control">
                  <button class="button is-link" type="submit">Sign up</button>
                </div>
              </div>
              <div class="field">
                <p class="has-text-grey">
                  <a @click="isLogin = true"
                    >Already have an account? Log in here.</a
                  >
                </p>
              </div>
            </form>
          </section>
        </div>
      </div>
    </div>
    <!-- Hero Section -->
    <main>
      <section id="hero" class="container-fluid py-5">
        <div class="row align-items-center">
          <div class="col-md-6 text-center text-md-start">
            <h1 class="display-2 mb-3">Discover Your Next Favorite Product</h1>
            <p class="lead mb-4">
              Explore our hand-picked selection of the latest and greatest
              products.
            </p>
            <a href="/products" class="btn btn-primary btn-lg">
              View Our Products
            </a>
          </div>
          <div class="col-md-6">
            <div class="hero-image"></div>
          </div>
        </div>
      </section>

      <!-- Services Section -->
      <section id="services" class="container my-5">
        <h2 class="text-center mb-5">Our Services</h2>
        <div class="row">
          <div class="col-md-4 mb-4">
            <div class="card">
              <div class="card-body">
                <h5 class="card-title">Fast Shipping</h5>
                <p class="card-text">
                  We offer fast and reliable shipping to get your products to
                  you as soon as possible.
                </p>
              </div>
            </div>
          </div>
          <div class="col-md-4 mb-4">
            <div class="card">
              <div class="card-body">
                <h5 class="card-title">Quality Products</h5>
                <p class="card-text">
                  We source only the highest quality products from trusted
                  suppliers to ensure your satisfaction.
                </p>
              </div>
            </div>
          </div>
          <div class="col-md-4 mb-4">
            <div class="card">
              <div class="card-body">
                <h5 class="card-title">Excellent Customer Service</h5>
                <p class="card-text">
                  Our dedicated customer service team is always available to
                  answer your questions and help you find what you need.
                </p>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- About Section -->
      <section id="about" class="container my-5">
        <h2 class="text-center mb-5">About Us</h2>
        <div class="row">
          <div class="col-md-6">
            <img
              src="/public/images/kids.jpg"
              alt="About Us"
              class="img-fluid rounded"
            />
          </div>
          <div class="col-md-6 my-auto">
            <p class="lead">
              Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec
              accumsan, urna sed ultricies euismod, massa purus bibendum metus,
              vel ultricies ex metus at justo. Praesent in consectetur risus.
            </p>
            <p>
              Morbi vel est id est finibus placerat. Suspendisse consectetur
              suscipit aliquam. Suspendisse faucibus quam ut elit vestibulum,
              vel fermentum libero efficitur. Vivamus pellentesque, erat nec
              varius efficitur, magna mauris hendrerit elit, ac dictum libero
              sapien sit amet neque. Etiam tempor elementum mi, vel iaculis
              neque eleifend eget. Fusce lobortis ipsum eu orci varius, at
              congue velit dignissim.
            </p>
          </div>
        </div>
      </section>
    </main>

    <% include('./footer') %>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/axios@0.21.1"></script>
    <script src="/vegas/vegas.min.js"></script>
    <script src="https://unpkg.com/vue@2.6.14"></script>

    <script>
      $(function () {
        $("#hero").vegas({
          slides: [
            { src: "./images/domino-164_6wVEHfI-unsplash.jpg" },
            { src: "./images/ivan-kazlouskij--YPtL-U6_MA-unsplash.jpg" },
            { src: "./images/keagan-henman-ZqXXVeRCyZ0-unsplash.jpg" },
            { src: "./images/tamanna-rumee-lpGm415q9JA-unsplash.jpg" },
          ],
          delay: 5000,
          timer: true,
          transition: "kenburns",
        });
      });
    </script>
    <script>
      const { createApp, ref } = Vue;

      const loginModalApp = {
        setup() {
          const showModal = ref(false);
          const isLogin = ref(true);
          const email = ref("");
          const password = ref("");
          const firstName = ref("");
          const lastName = ref("");

          const login = async () => {
            try {
              const response = await axios.post("/api/users/login", {
                email: email.value,
                password: password.value,
              });
              localStorage.setItem("token", response.data.token);
              window.location.reload();
            } catch (error) {
              alert("Invalid email or password");
            }
          };

          const signup = async () => {
            try {
              await axios.post("/users", {
                email: email.value,
                password: password.value,
                firstName: firstName.value,
                lastName: lastName.value,
              });
              const response = await axios.post("/api/users/login", {
                email: email.value,
                password: password.value,
              });
              localStorage.setItem("token", response.data.token);
              window.location.reload();
            } catch (error) {
              alert("An error occurred while signing up");
            }
          };

          return {
            showModal,
            isLogin,
            email,
            password,
            firstName,
            lastName,
            login,
            signup,
          };
        },
      };

      createApp(loginModalApp).mount("#login-modal-app");
    </script>
  </body>
</html>
